{"version":3,"sources":["file:///D:/cocos/badminton/badminton/assets/Scripts/GameManager.ts"],"names":["_decorator","Component","Animation","Node","Prefab","CCInteger","AudioSource","instantiate","PhysicsSystem2D","Collider2D","Contact2DType","Label","Vec2","PlayerController","BossController","ccclass","property","GameState","BlockType","BlockSizeX","BlockSizeY","GameManger","type","roadHeight","feacherCount","_road","start","setCurState","GS_INIT","node","on","updateScore","curScore","Score","getComponent","string","toString","oneTotwo","startButton1","active","startMenu1","startMenu2","startExit","startStart","startSettings","twoTogame","startGame","init","StCo","play","pause","gameGround1","instance","enable","generateRoad","player","playerCtrl","initInput","value","GS_PLAYING","GS_END","endGame1","_isJump","_isMove","Body","gravityScale","linearVelocity","curChildren","children","cur","setScale","playerRigid","body","enabledContactListener","scoreAnim","setTimeout","removeAllChildren","toBoss","camera","bossCtrl","initBoss","generateRoadBoss","i","block","spawnBlockByType","BT_STONE","bg4","addChild","setPosition","onContactFeather","selfCollider","otherCollider","contact","blockAnimation","Bounce","emit","onContactFire","_roadCur","j","roadLength","Math","floor","random","curNode","collider","BEGIN_CONTACT","fireAnimation","boxPrefab","BT_FIRE","firePrefab","BT_FEATHER","featherPrefab","update","deltaTime"],"mappings":"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","sourcesContent":["import { _decorator, Component, Vec3, EventMouse, input, Input, Animation, Node, Prefab, CCInteger, AudioSource, instantiate, PhysicsSystem2D, Collider2D, Contact2DType, IPhysics2DContact, animation, AnimationState, Label, RigidBody2D, Vec2, BoxCollider2D } from 'cc';\r\nimport { PlayerController } from './PlayerController';\r\nimport { BossController } from './BossController';\r\nconst { ccclass, property } = _decorator;\r\n\r\nenum GameState {\r\n    GS_INIT,\r\n    GS_PLAYING,\r\n    GS_END,\r\n};\r\n\r\nenum BlockType {\r\n    BT_NONE,\r\n    BT_STONE,\r\n    BT_FIRE,\r\n    BT_FEATHER,\r\n};\r\nconst BlockSizeX = 75;\r\nconst BlockSizeY = 75;\r\n@ccclass('GameManger')\r\nexport class GameManger extends Component {\r\n    @property({ type: Node })\r\n    startButton1: Node = null;//从第一个开始界面调到第二个界面的按钮\r\n    @property({ type: Node })\r\n    startMenu1: Node = null;//第一个背景\r\n    @property({ type: Node })\r\n    startMenu2: Node = null;\r\n    @property({ type: Node })\r\n    startSettings: Node = null;\r\n    @property({ type: Node })\r\n    startStart: Node = null;\r\n    @property({ type: Node })\r\n    startExit: Node = null;\r\n    @property({ type: Node })\r\n    gameGround1: Node = null;\r\n    @property({ type: Node })\r\n    gameGround2: Node = null;\r\n    @property({ type: Node })\r\n    player: Node = null;\r\n    @property({ type: Node })\r\n    Score: Node = null;\r\n    @property({ type: Prefab })\r\n    public boxPrefab: Prefab | null = null;\r\n    @property({ type: Prefab })\r\n    public featherPrefab: Prefab | null = null;\r\n    @property({ type: Prefab })\r\n    public firePrefab: Prefab | null = null;\r\n    @property({ type: CCInteger })\r\n    public roadLength: number = 30;\r\n    public roadHeight: number = 30;\r\n    public feacherCount: number = 0;\r\n    private _road = [];\r\n\r\n    @property({ type: PlayerController })\r\n    public playerCtrl: PlayerController | null = null;\r\n\r\n    @property({ type: BossController })\r\n    public bossCtrl: BossController | null = null;\r\n\r\n    @property({ type: Node })\r\n    StCo: Node = null;\r\n\r\n    @property({ type: Node })\r\n    camera: Node = null;\r\n\r\n    @property({ type: Node })\r\n    bg4: Node = null;\r\n    start() {\r\n        this.setCurState(GameState.GS_INIT);\r\n        this.node.on('GetScore', this.updateScore, this)\r\n    }\r\n    updateScore(curScore: number) {\r\n        this.Score.getComponent(Label).string = curScore.toString();\r\n    }\r\n    oneTotwo() {\r\n        this.startButton1.active = false;\r\n        this.startMenu1.active = false;\r\n        this.startMenu2.active = true;\r\n        this.startExit.active = true;\r\n        this.startStart.active = true;\r\n        this.startSettings.active = true;\r\n    }\r\n    twoTogame() {\r\n        this.startGame();\r\n    }\r\n    init() {\r\n        this.StCo.getComponent(AudioSource).play();\r\n    }\r\n    startGame() {\r\n        this.StCo.getComponent(AudioSource).pause();\r\n        this.startMenu2.active = false;\r\n        this.startExit.active = false;\r\n        this.startStart.active = false;\r\n        this.startSettings.active = false;\r\n        this.gameGround1.active = true;\r\n        PhysicsSystem2D.instance.enable = true;\r\n        this.generateRoad();\r\n        this.feacherCount = 0;\r\n        this.player.active = true;\r\n        this.playerCtrl.initInput(true);\r\n    }\r\n    setCurState(value: GameState) {\r\n        switch (value) {\r\n            case GameState.GS_INIT:\r\n                this.init();\r\n                break;\r\n            case GameState.GS_PLAYING:\r\n                this.startGame();\r\n                break;\r\n            case GameState.GS_END:\r\n                this.endGame1();\r\n                break;\r\n        }\r\n    }\r\n    endGame1() {\r\n        this.playerCtrl.initInput(false);\r\n        this.playerCtrl._isJump = false;\r\n        this.playerCtrl._isMove = false;\r\n        this.playerCtrl.Body.gravityScale = 0;\r\n        this.playerCtrl.Body.linearVelocity = new Vec2(0, 0);\r\n        let curChildren = this.node.children;\r\n        for (let cur of curChildren) {\r\n            cur.setScale(0, 0);\r\n        }\r\n        let playerRigid = this.gameGround1.getComponent(Collider2D);\r\n        if (playerRigid) {\r\n            playerRigid.body.enabledContactListener = false;\r\n        }\r\n        let scoreAnim = this.Score.getComponent(Animation);\r\n        if (scoreAnim) {\r\n            scoreAnim.play('score_bigger');\r\n        }\r\n        this.player.active = false;\r\n        setTimeout(() => {\r\n            this.node.removeAllChildren();\r\n        }, 100);\r\n        setTimeout(() => {\r\n            this.toBoss();\r\n        }, 3000);\r\n    }\r\n    toBoss() {\r\n        this.gameGround1.getComponent(Animation).play('bg3xs');\r\n        setTimeout(() => {\r\n            this.camera.active = false;\r\n            this.gameGround1.active = false;\r\n            this.bossCtrl.initBoss();\r\n            setTimeout(() => {\r\n                this.generateRoadBoss();\r\n            }, 1000);\r\n        }, 1000);\r\n\r\n    }\r\n    generateRoadBoss() {\r\n        for (let i = -10; i <= 10; i++) {\r\n            let block: Node | null = this.spawnBlockByType(BlockType.BT_STONE);\r\n            this.bg4.addChild(block);\r\n            block.setPosition((i) * BlockSizeY, 4.3 * BlockSizeX, 0);\r\n        }\r\n        for (let i = -10; i <= 10; i++) {\r\n            let block: Node | null = this.spawnBlockByType(BlockType.BT_STONE);\r\n            this.bg4.addChild(block);\r\n            block.setPosition((i) * BlockSizeY, -4.3 * BlockSizeX, 0);\r\n        }\r\n        for (let i = -4.3; i <= 4.3; i++) {\r\n            let block: Node | null = this.spawnBlockByType(BlockType.BT_STONE);\r\n            this.bg4.addChild(block);\r\n            block.setPosition(-10 * BlockSizeY, (i) * BlockSizeX, 0);\r\n        }\r\n        for (let i = -4.3; i <= 4.3; i++) {\r\n            let block: Node | null = this.spawnBlockByType(BlockType.BT_STONE);\r\n            this.bg4.addChild(block);\r\n            block.setPosition(10 * BlockSizeY, (i) * BlockSizeX, 0);\r\n        }\r\n    }\r\n    onContactFeather(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null) {\r\n        let block = selfCollider.node;\r\n        let blockAnimation = block.getComponent(Animation);\r\n        blockAnimation.play('feather_fly');\r\n        this.playerCtrl.Bounce(20);\r\n        selfCollider.body.enabledContactListener = false;\r\n        this.feacherCount++;\r\n        this.node.emit('GetScore', this.feacherCount);\r\n        // let blockAnimationState = blockAnimation.getState('feather_fly');\r\n        setTimeout(() => {\r\n            block.active = false;\r\n        }, 2000);\r\n    }\r\n    onContactFire(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null) {\r\n        selfCollider.body.enabledContactListener = false;\r\n        this.setCurState(GameState.GS_END);\r\n    }\r\n    //生成地块\r\n    generateRoad() {\r\n        this.node.removeAllChildren();\r\n        this._road = [];\r\n        for (let i = 1; i <= this.roadHeight; i++) {\r\n            let _roadCur: BlockType[] = [];\r\n            for (let j = 1; j <= this.roadLength; j++) {\r\n                if ((i % 2 == 1)) {\r\n                    _roadCur[j] = Math.floor(Math.random() * 4);\r\n                }\r\n                else {\r\n                    _roadCur[j] = 0;\r\n                }\r\n            }\r\n            this._road[i] = _roadCur;\r\n        }\r\n        for (let i = 1; i <= this.roadHeight; i++) {\r\n            for (let j = 1; j <= this.roadLength; j++) {\r\n                let block: Node | null = this.spawnBlockByType(this._road[i][j]);\r\n                if (j - 1 != 0) {\r\n                    if (block) {\r\n                        if (this._road[i][j] == 3) {\r\n                            let curNode = new Node;\r\n                            curNode.addChild(block);\r\n                            this.node.addChild(curNode);\r\n                            block.setScale(1, -1);\r\n                            let collider = block.getComponent(Collider2D);\r\n                            if (collider) {\r\n                                collider.on(Contact2DType.BEGIN_CONTACT, this.onContactFeather, this);\r\n                            }\r\n                            curNode.setPosition((j - 1) * BlockSizeY, (i - 15) * BlockSizeX, 0);\r\n                            continue;\r\n                        }\r\n                        this.node.addChild(block);\r\n                        if (this._road[i][j] == 2) {\r\n                            let fireAnimation = block.getComponent(Animation);\r\n                            if (fireAnimation) {\r\n                                fireAnimation.play('fire1');\r\n                            }\r\n                            let collider = block.getComponent(Collider2D);\r\n                            if (collider) {\r\n                                collider.on(Contact2DType.BEGIN_CONTACT, this.onContactFire, this);\r\n                            }\r\n                        }\r\n                        block.setPosition((j - 1) * BlockSizeY, (i - 15) * BlockSizeX, 0);\r\n                    }\r\n                } else if (i - 15 == -1) {\r\n                    block = this.spawnBlockByType(BlockType.BT_STONE);\r\n                    this.node.addChild(block);\r\n                    block.setPosition((j - 1) * BlockSizeY, (i - 15) * BlockSizeX, 0);\r\n                }\r\n            }\r\n        }\r\n\r\n        for (let i = -5; i <= this.roadLength + 5; i++) {\r\n            let block: Node | null = this.spawnBlockByType(BlockType.BT_STONE);\r\n            this.node.addChild(block);\r\n            block.setPosition((i - 1) * BlockSizeY, (this.roadHeight - 15 + 5) * BlockSizeX, 0);\r\n        }\r\n        for (let i = -5; i <= this.roadLength + 5; i++) {\r\n            let block: Node | null = this.spawnBlockByType(BlockType.BT_STONE);\r\n            this.node.addChild(block);\r\n            block.setPosition((i - 1) * BlockSizeY, (- 15 - 5) * BlockSizeX, 0);\r\n        }\r\n        for (let i = -5; i <= this.roadHeight + 5; i++) {\r\n            let block: Node | null = this.spawnBlockByType(BlockType.BT_STONE);\r\n            this.node.addChild(block);\r\n            block.setPosition((this.roadLength + 5 - 1) * BlockSizeY, (i - 15) * BlockSizeX, 0);\r\n        }\r\n        for (let i = -5; i <= this.roadHeight + 5; i++) {\r\n            let block: Node | null = this.spawnBlockByType(BlockType.BT_STONE);\r\n            this.node.addChild(block);\r\n            block.setPosition((-5 - 1) * BlockSizeY, (i - 15) * BlockSizeX, 0);\r\n        }\r\n    }\r\n    spawnBlockByType(type: BlockType) {\r\n        if (!this.boxPrefab) {\r\n            return null;\r\n        }\r\n        let block: Node | null = null;\r\n        switch (type) {\r\n            case BlockType.BT_STONE:\r\n                block = instantiate(this.boxPrefab);\r\n                break;\r\n            case BlockType.BT_FIRE:\r\n                block = instantiate(this.firePrefab);\r\n                break;\r\n            case BlockType.BT_FEATHER:\r\n                block = instantiate(this.featherPrefab);\r\n                break;\r\n        }\r\n        return block;\r\n    }\r\n    update(deltaTime: number) {\r\n\r\n    }\r\n}\r\n"]}